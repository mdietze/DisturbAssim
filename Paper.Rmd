---
title: |
    | Ecological Applications
    | Article
    | Assimilating disturbance: Toward real-time monitoring and forecasting
author:
  - Michael C. Dietze 1
  - Shawn P. Serbin 2
  - Robert Kennedy 3
  - Beverly E. Law 4
  - 1 - Earth and Environment, Boston University, Boston, MA
  - 2 - Environmental and Climate Sciences Department, Brookhaven National Laboratory, Upton, NY
  - 3 - Geography, Environmental Sciences, and Marine Resource Mgmt, Oregon State University, Corvallis, OR
  - 4 - Forest Ecosystems & Society, Oregon State University, Corvallis, OR
  - Corresponding Author = Michael C. Dietze
#date: '`r Sys.Date()`'
keywords: Disturbance detection, Ensemble Data Assimilation, Natural Climate Solutions, Carbon Cycle
header-includes:
    - \usepackage{setspace}\doublespacing
    - \usepackage[left]{lineno}
    - \linenumbers
output:
  bookdown::pdf_document2: 
    fig_caption: yes
    number_sections: yes
    toc: no
    keep_tex: true
  bookdown::html_document2: 
    fig_caption: yes
    number_sections: yes
    toc: yes
    keep_tex: true
  bookdown::word_document2: 
    fig_caption: yes
    number_sections: yes
    toc: no
    keep_tex: true
bibliography: bibliography.bibtex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*Open Research Statement:*

Data are already published and publicly available, with those publications properly cited in this submission. Data sets used for this research are as follows:

* The Landtrendr aboveground biomass product [@Kennedy2018] and disturbance product [@KENNEDY2015] for tile h03v04 was downloaded from http://emapr.ceoas.oregonstate.edu/pages/data/viz/index.html.
* The 2001 National Land Cover Dataset [@HOOPER2018] is available from https://www.mrlc.gov/.
* DayMet meteorological data [@thornton2021] were downloaded using the daymetr R package [@daymetr].
* Ameriflux eddy covariance data and supplemental BADM (Biological, Ancillary, Disturbance, and Management) metadata for site US-ME2 [@van2005, @berner2016] were downloaded from https://ameriflux.lbl.gov/.
 
This submission uses novel code, which is provided, per our requirements, in an external repository to be evaluated during the peer review process. Code is available at https://github.com/mdietze/DisturbAssim

\newpage

# Abstract {-}

Current approaches to bottom-up disturbance monitoring rely heavily on the detection of land-use, land-use change, and forestry through remote sensing, but often account for ecosystem impacts using simple look-up tables. By contrast, process models are frequently used to analyze and predict disturbance dynamics in greater mechanistic detail. Once observations are available, however, we need to update model predictions, especially for stochastic processes such as disturbance. State data assimilation (SDA) is designed specifically to update predictions, nudging modeled states back toward reality in proportion to the uncertainties in the model and the data, but current SDA algorithms are designed to update continuous states, not discrete disturbances.
Here we develop a new Bayesian SDA algorithm that combines a discrete Multinomial state-and-transition framework with conventional ensemble filtering SDA approaches. To demonstrate the potential for assimilating disturbance, we applied the Multinomial SDA to the Very Simple Ecosystem Model (VSEM), performing both simulated data experiments with known disturbances and testing the algorithm against real-world disturbances detected in the LandTrender data product for central Oregon.
With simulated disturbance we not only demonstrate the ability to detect discrete disturbance events but also to avoid false positives. We also demonstrated the ability to fuse multiple data types to successfully distinguish different disturbance types, and to probabilistically capture vegetation type ‘switching’ events within the assimilation and ensemble forecast. To apply this to real-world data we selected 356 conifer forest sites for testing, using the Landtrendr disturbance product to stratify by four disturbance types (cut, burn, pest, and other). We then assimilated the 30m Landtrendr annual aboveground biomass product from 1990-2017 and assessed the rate of disturbance detection. With just AGB, our assimilation was sensitive to disturbances that reduced biomass by >1.5 kg/m2 but underpredicted defoliation disturbances, which could be improved by including LAI in the assimilation.
Moving forward, the SDA framework provides an exciting opportunity to fuse multiple data sources to holistically improve real-time disturbance detection, impact assessment (e.g. carbon sequestration), and forecasts of both disturbance events and post-disturbance recovery within a single integrated system.

\newpage

# Introduction

Considerable time and resources have been devoted to developing "bottom-up" terrestrial carbon (C) cycle data products at landscape- to global-scales [@SOCCR2]. Such efforts have drawn upon various combinations of remote sensing, inventory data, field-based sensors (e.g., eddy covariance), and process-based models with the dual aims of improving our understanding of C cycle processes and the monitoring, reporting, and verification (MRV) of C stocks and fluxes [@AR6WG3; @SOCCR2]. MRV in particular is driven by a combination of local, national, and international reporting requirements (e.g. UN Framework Convention on Climate Change) and increasingly by the demand for natural climate solutions and carbon market certification [@NOVICK2022; @sands1992united].

Particularly critical parts of carbon MRV are the impacts of land use, land use change, forestry (LULUCF) and natural disturbance (e.g. wildfire, pests, wind), which can have major impacts on carbons stocks and accumulation, quickly turning C sinks into large sources [@harris2016; @Law2018; @Hudiburg_2019]. Looking to the future, many types of disturbance are predicted to become more frequent and/or intense [@seidl_forest_2017; Dale2001]. Compounding this, C stocks are likely to be more sensitive to changes in disturbance regimes than to the direct ecophysiological effects of climate and elevated $CO_2$ [@McDowell2020; @Andrews2018]. Natural and anthropogenic disturbance events are also places where management and policy can have the greatest impact on carbon pools and fluxes, in terms of increasing resilience, managing restoration and recovery, and avoiding transitions to alternative system states. 

While there are a variety of approaches for monitoring and understanding C cycle processes for intact ecosystems, when it comes to disturbance the status quo is based on detecting disturbances (e.g., via remote sensing) and then using a simple look up table (i.e., emission factors) to quantify C cycle impacts [@eggleston2006; @Mitchell2017; @BULLOCK2021; @harris2021]. Active sensors such as lidar and SAR more directly capture changes in aboveground biomass, but do not inform other pools and fluxes [@Mitchell2017].  While the closely related fields of disturbance detection and classification, and LULUCF monitoring have made considerable advances [@KENNEDY2010; @ZHU2020; @VERBESSELT2012], the reliance on simple static look-up tables to quantify emissions is clearly missing considerable variability across space, time, and disturbance intensity.

An alternative to look-up tables is to rely on process-based models to capture the spatiotemporal changes in the C cycle post disturbance. However, by themselves process-based models are going to misrepresent many disturbances, either under- or over-predicting individual events, both because there is an inherently stochastic component to disturbances and because the representation of disturbance is highly simplified in most models [@FisherKoven2020; @KEANE2015], where major classes of disturbance are often absent (e.g., forest pests, [@Hicke2012; @DietzeMatthes2014]). Ultimately, MRV efforts should reflect the actual disturbance events, not those that were predicted. On the other hand, prescribing disturbance in models ignores the uncertainty in disturbance detection and brings us back to using look-up tables to capture how the disturbance is represented in the model.

```{r conceptualFig, fig.width=7, fig.cap="Conceptual representation of a state data assimilation workflow. (1) Uncertainties in model inputs (e.g., initial conditions [IC], drivers, parameters) are sampled to generate ensembles of model inputs that (2) are fed into a model to produce probabilistic forecasts [blue]. (3) When new observations [green] become available they are (4) analyzed statistically to produce an updated estimate of the state of the system [pink]. Here we introduce a new Analysis algorith, the Multinomial Filter and test is using the Very Simple Ecosystem Model (VSEM) as the model and remotely sended aboveground biomass (AGB) as the data constraint.",echo=FALSE}
knitr::include_graphics("WorkflowFigure.png",dpi=144)
```


State data assimilation (SDA) offers a promising alternative to these two approaches, directly addressing their challenges while building on their respective strengths, and is already being used in other aspects of carbon MRV [@Baatz2021]. The basic idea behind SDA is that a process model is run numerous times to make a probabilistic prediction of the full carbon cycle (pools and fluxes) from one point in time to the next (Figure \@ref(fig:conceptualFig)). It does this by sampling over the uncertainties about the current state of the system, while providing the option also sampling the parameter, driver, and process (residual) uncertainties. This multivariate prediction represents our (Bayesian) _prior_ understanding of the carbon cycle that is then updated, using Bayes' Theorem, based on observations of one or more of these pools or fluxes [@Dietze2017a; @Wikle2007]. In essence, data assimilation “nudges” the model back towards the data, with the size of the nudge proportional to the relative uncertainties in the model (prior) and the data (Likelihood). Importantly, the resulting posterior estimates are able to fuse numerous data constraints simultaneously, are robust to large amounts of missing observations in space and time, and provide a comprehensive uncertainty estimate. SDA can even update pools and fluxes that are not directly observed, which it does by leveraging the model ensemble covariance between observed and unobserved variables. Finally, unlike monitoring-only systems, data assimilation systems can seamlessly transition from reconstructing the past (a.k.a. reanalysis), to real-time monitoring (a.k.a. nowcast), to predictive forecasts [@Dietze2017a]. A handful of different terrestrial carbon data assimilation systems are now in operation (e.g., CLM-DART, CCDAS, PEcAn), with applications at site [@Raiho2020], regional [@Raczka2021], continental [@Dokoohaki2022], and global [@Fox2022; @Rayner2005] scales.

The potential advantages of applying SDA to address the disturbance problem in carbon MRV are straightforward. Ensembles of model runs could capture the stochasticity of natural disturbance regimes while also providing a process-based representation of both disturbance and carbon cycle processes across numerous possible sources of fine-scale heterogeneity (current vegetation conditions, climate, soils, etc.). The assimilation would then update the predictions based on what actually happened, formally accounting for the uncertainty in the disturbance observations, as well as allowing for the integration of other data constraints (e.g., inventory, sensor, remote sensing). These observations could then either reinforce or cast doubt upon the disturbance classification, while also informing our understanding of pre- and post-disturbance heterogeneity. Data assimilation even has the potential to capture disturbances that are not represented explicitly in a model but are apparent in the observations (e.g. insect defoliation).

The problem is that, when it comes to assimilating disturbance, conventional data assimilation does not actually work (Figure \@ref(fig:enkf)). For reasons we'll explain in the _Methods_, instead of nudging a disturbed system to a disturbed state in the model, it nudges it to a "no man's land" in between the disturbed and undisturbed state that doesn't represent either state well. It can then take multiple iterations of the assimilation for these nudges to get the model back on track, in effect predicting gradual ecosystem degradation rather than a discrete disturbance and recovery, during which time this gradual decline will be misrepresented in MRV accounting (missing removals, fire combustion, etc.) and misinterpreted by the model (e.g. missing recruitment and respiration responses).

Here we present a potential solution -- a novel assimilation algorithm that accounts for both the discrete nature of disturbance events and the continuous variability in disturbance magnitude. This assimilation is based on the idea of representing the ensemble forecast as a multimodal mixture module, with different modes capturing the undisturbed state and multiple alternative disturbances, and adding a Multinomial probability to the assimilation to allow it to discretely jump between states. In the following sections we will more formally explain the disturbance assimilation problem and derive our proposed solution. We will then apply this statistical model to both simulated data with known disturbances and real-world observations, making use of the Very Simple Ecosystem Model (VSEM) for predictions and remotely-sensed Landtrendr biomass and disturbance data products as observations, using the ponderosa pine ( _Pinus ponderosa_ ) ecosystems of central Oregon as a testbed [@Kennedy2018; @BayesianTools]. Overall, this manuscript aims to provide a proof-of-concept for the idea of disturbance assimilation, laying the foundation for future applications and algorithm improvements.

<!---- METHODS --->
```{r child = 'methods.Rmd'}
```

<!---- RESULTS --->
```{r child = 'results.Rmd'}
```

<!---- DISCUSSION --->
```{r child = 'discussion.Rmd'}
```

# Acknowledgements

MCD and SPS were supported by funds from NASA (20-CMS20-0030, 16-CMS16-0007), while MCD was additionally supported by the National Science Foundation (NSF 1458021, NSF 1638577, NSF 1702996, NSF 2213580).
RK was supported by NASA grants NNX16AQ25G and NN12AP76G.
We would like to thank members of MCD's Ecological Forecasting lab (Alexis Helgeson, Charlotte Malmborg, Zoey Werbin, Dongchen Zhang) for input they provided on the draft manuscript.

# Author Contributions

MCD: Conceptualization, funding acquisition, model and software development, analysis, original draft, reviewing and editing of writing. SPS: Conceptualization, funding acquisition, and review and editing of writing. RK and BEL: Data generation and curation, review and editing of writing.

# Conflict of Interest Statement

The authors certify that they have no affiliations with or involvement in any
organization or entity with any financial or non-financial interest in
the subject matter or materials discussed in this manuscript.

\newpage
# References

<div id="refs"></div>
\newpage

# (APPENDIX) Appendix {-} 

<!---- SUPPLEMENTAL MATERIAL --->
```{r child = 'supplemental.Rmd'}
```
